<!DOCTYPE html>
<html class='no-js' lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>lab2023 | web & mobile development, graphic design company - Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması
</title>
<meta content='Designers and developers for hire' name='description'>
<meta content='design, ruby, ruby on rails, ios, android, sencha, istanbul, ankara, denizli, turkey' name='keywords'>
<link href="assets/stylesheets/application.css" rel="stylesheet" /><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" /><link href="assets/stylesheets/swiper-bundle.min.css" rel="stylesheet" />
<link href="assets/images/favicon.png" rel="icon" type="image/png" />
<meta content='Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması' name='description'>
<meta content='paperclip, dropzone, tr' name='keywords'>


</head>
<body id='blog'>
<header class='header'>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1'>
<a href="/blog"><img class="logo pull-right" width="252" height="253" src="assets/images/logo.png" alt="Logo" />
</a></div>
<div class='col-lg-8'>
<h1>
<a href="/blog">lab2023's blog posts</a>
<a href="http://lab2023.com/feed.xml" target="_blank"><i class='fa fa-rss'></i>
</a></h1>
<div class='row'>
<div class='col-lg-3'>
<p>
<a href="/"><i class='fa fa-arrow-circle-left'></i>
lab2023.com
</a></p>
</div>
<div class='col-lg-9' id='language_linked'>
<p>
<a href="/tag/tr.html">Türkçe
</a>·
<a href="/tag/en.html">English
</a>·
<a href="/tag/es.html">Español
</a>·
<a href="/tag/ru.html">Русский
</a></p>
</div>
</div>
</div>
</div>
</div>
</header>

<!-- share-buttons js code -->
<div id='fb-root'>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/tr_TR/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
  (function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs'));
</script>
</div>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1 article-meta'>
<h5>July  6, 2013</h5>
<span class='tag'><a href="/tag/paperclip.html">paperclip</a></span>
<span class='tag'><a href="/tag/dropzone.html"> dropzone</a></span>
<span class='tag'><a href="/tag/tr.html"> tr</a></span>
<!-- Share buttons -->
<ul class='share_button'>
<li>
<div class='fb-share-button' data-href='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' data-type='button_count'></div>
</li>
<li>
<a class='twitter-share-button' data-text='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' data-via='lab2023' href='https://twitter.com/share'></a>
</li>
<li>
<script src='//platform.linkedin.com/in.js' type='text/javascript'>
<![CDATA[
    lang: en_US
]]>
</script>
<script data-url='http://lab2023.com/ruby-on-rails-paperclip-ve-dropzone-js-ile-surukle-birak-dosya-yukleme-uygulamasi.html' type='IN/Share'></script>
</li>
</ul>
</div>
<div class='col-lg-8'>
<article class='post'>
<h1>Ruby on Rails, Paperclip ve Dropzone.js ile sürükle bırak dosya yükleme uygulaması</h1>
<p><strong>Dropzone.js</strong></p>

<p>Daha önceki projelerde jquery-fileupload-rails gemini kullanmıştım ama onlarca satır haml ve erb kodu yazmak pek içime sinmemişti bu işin daha basit bir yöntemi olmalı demiştim bu arayışıta dropzone ile karşılaştım basitliği ve eski tarayıcılara destek vermesi beni cezbetti (like a jquery 2)</p>

<!--more-->

<p><strong>Diğerlerinden Farkı</strong></p>

<ul>
<li>  Küçük boyut</li>
<li>  Framework bağımsız</li>
<li>  Güncel Tarayıcı API&#39;leri</li>
<li>  Sade Tasarım</li>
<li>  Resimlerde Küçültülmüş önizleme</li>
</ul>

<h1 id="kurulum"><strong>Kurulum</strong></h1>

<p>Rails projemizi oluşturalım</p>

<p><code>rails new rails-paperclip-dropzone-example</code></p>

<h2 id="gemler">Gemler</h2>

<p>Rails projemize ilk olarak dropzonejs-rails ve paperclip gemlerini dahil ediyoruz.</p>
<div class="highlight"><pre class="highlight plaintext"><code>gem 'dropzonejs-rails'
gem 'paperclip'
</code></pre></div>
<h2 id="assets">Assets</h2>

<p>application.css.sass</p>
<div class="highlight"><pre class="highlight plaintext"><code>@import 'dropzone/dropzone'
</code></pre></div>
<p>application.js.coffee</p>
<div class="highlight"><pre class="highlight plaintext"><code>#= require dropzone
</code></pre></div>
<h2 id="scaffold">Scaffold</h2>

<p>Gerekli model ve controllerları scaffold yardımıyla oluşturalım.</p>

<p><code>rails g scaffold product name:string</code></p>

<p><code>rails g scaffold photo photo:attachment product:references</code></p>

<p>prodcut.rb model dosyasına aşağıdaki ilişkiyi tanımlıyoruz.</p>
<div class="highlight"><pre class="highlight plaintext"><code>has_many :photos
</code></pre></div>
<h1 id="kullan-m"><strong>Kullanımı</strong></h1>

<p>application.js.coffee</p>
<div class="highlight"><pre class="highlight coffeescript"><code><span class="nx">Dropzone</span><span class="p">.</span><span class="na">options</span><span class="p">.</span><span class="na">photoDropzone</span> <span class="o">=</span>
  <span class="na">paramName</span><span class="o">:</span> <span class="s">"photo"</span>
  <span class="na">maxFilesize</span><span class="o">:</span> <span class="mi">2</span> <span class="c1">#mb</span>
  <span class="na">addRemoveLinks</span><span class="o">:</span> <span class="no">true</span>
  <span class="na">init</span><span class="o">:</span> <span class="o">-&gt;</span>
    <span class="vi">@</span><span class="na">on</span> <span class="s">'removedfile'</span><span class="p">,</span> <span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="o">-&gt;</span>
      <span class="k">if</span> <span class="nx">file</span><span class="p">.</span><span class="na">xhr</span>
        <span class="nx">$</span><span class="p">.</span><span class="na">ajax</span>
          <span class="na">url</span><span class="o">:</span> <span class="s">"</span><span class="si">#{</span><span class="nx">$</span><span class="p">(</span><span class="s">"#photo-dropzone"</span><span class="p">).</span><span class="na">attr</span> <span class="s">"action"</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">JSON</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="na">xhr</span><span class="p">.</span><span class="na">response</span><span class="p">).</span><span class="na">id</span><span class="si">}</span><span class="s">"</span>
          <span class="na">type</span><span class="o">:</span> <span class="s">'DELETE'</span>
</code></pre></div>
<p>Sürükle bırak formu için aşağıdaki kodu formun çıkmasını istediğimiz haml dosyasına yazıyoruz.`</p>
<div class="highlight"><pre class="highlight haml"><code><span class="p">=</span> <span class="n">form_for</span> <span class="p">[</span><span class="vi">@product</span><span class="p">,</span> <span class="no">Photo</span><span class="p">.</span><span class="nf">new</span><span class="p">],</span> <span class="ss">multipart: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">html: </span><span class="p">{</span><span class="ss">class: :dropzone</span><span class="p">,</span> <span class="ss">id: </span><span class="s1">'photo-dropzone'</span><span class="p">}</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">hidden_field</span> <span class="ss">:photo</span>
  <span class="p">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">hidden_field</span> <span class="ss">:product_id</span><span class="p">,</span> <span class="ss">value: </span><span class="vi">@product</span><span class="p">.</span><span class="nf">id</span>
</code></pre></div>
<p>Controller içinde sadece create methodunun bulunması yeterli tabi dropzone içersinde silmek için buton çıkarabileceğiniz bir ayar mevcut bununla birlikte silme gibi işlemleri halledebileceğinizi düşünüyorum.</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">create</span>
  <span class="vi">@photo</span> <span class="o">=</span> <span class="no">Photo</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">photo: </span><span class="n">params</span><span class="p">[</span><span class="ss">:photo</span><span class="p">],</span> <span class="ss">product_id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:photo</span><span class="p">][</span><span class="ss">:product_id</span><span class="p">])</span>
  <span class="n">render</span> <span class="ss">json: </span><span class="vi">@photo</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">destroy</span>
  <span class="vi">@photo</span> <span class="o">=</span> <span class="no">Photo</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="vi">@photo</span><span class="p">.</span><span class="nf">destroy</span>
  <span class="n">render</span> <span class="ss">nothing: </span><span class="kp">true</span>
<span class="k">end</span>
</code></pre></div>
<p>Toplamda 10 satırda projelerinize sürükle bırak dosya yükleme formu yapabilirsiniz. <img alt="dropzonejs" width="881" height="550" src="assets/images/articles/2013-07-06-dropzone.png" /></p>

<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'lab2023';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>
Please enable JavaScript to view the
<a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
</noscript>
<a class='dsq-brlink' href='http://disqus.com'>
comments powered by
<span class='logo-disqus'>Disqus</span>
</a>
</article>
</div>
</div>
</div>
<footer class='footer'>
<h4>© 2009 ~ 2020 LAB2023, CORP.</h4>
<p>The all designs, materials and contents trademarks of lab2023, corp.</p>
</footer>

</body>
<!-- Javascripts -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script><script src="assets/javascripts/vendor/swiper-bundle.min.js"></script><script src="assets/javascripts/application.js"></script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12243799-3']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</html>
