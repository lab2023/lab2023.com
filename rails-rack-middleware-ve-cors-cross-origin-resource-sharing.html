<!DOCTYPE html>
<html class='no-js' lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>lab2023 | web & mobile development, graphic design company - Rails, Rack Middleware ve CORS (Cross-origin resource sharing)
</title>
<meta content='Designers and developers for hire' name='description'>
<meta content='design, ruby, ruby on rails, ios, android, sencha, istanbul, ankara, denizli, turkey' name='keywords'>
<link href="assets/stylesheets/application.css" rel="stylesheet" /><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" /><link href="assets/stylesheets/swiper-bundle.min.css" rel="stylesheet" />
<link href="assets/images/favicon.png" rel="icon" type="image/png" />
<meta content='Rails, Rack Middleware ve CORS (Cross-origin resource sharing)' name='description'>
<meta content='cors, cross-origin resources sharing, middleware, rack, rails, tr' name='keywords'>
<meta content='Tayfun Öziş ERİKAN' name='author'>


</head>
<body id='blog'>
<header class='header'>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1'>
<a href="/blog"><img class="logo pull-right" width="252" height="253" src="assets/images/logo.png" alt="Logo" />
</a></div>
<div class='col-lg-8'>
<h1>
<a href="/blog">lab2023's blog posts</a>
<a href="http://lab2023.com/feed.xml" target="_blank"><i class='fa fa-rss'></i>
</a></h1>
<div class='row'>
<div class='col-lg-3'>
<p>
<a href="/"><i class='fa fa-arrow-circle-left'></i>
lab2023.com
</a></p>
</div>
<div class='col-lg-9' id='language_linked'>
<p>
<a href="/tag/tr.html">Türkçe
</a>·
<a href="/tag/en.html">English
</a>·
<a href="/tag/es.html">Español
</a>·
<a href="/tag/ru.html">Русский
</a></p>
</div>
</div>
</div>
</div>
</div>
</header>

<!-- share-buttons js code -->
<div id='fb-root'>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/tr_TR/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
  (function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs'));
</script>
</div>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1 article-meta'>
<h4><a href="http://twitter.com/toziserikan" target="_blank">Tayfun Öziş ERİKAN</a></h4>
<h5>May 31, 2013</h5>
<span class='tag'><a href="/tag/cors.html">cors</a></span>
<span class='tag'><a href="/tag/cross-origin-resources-sharing.html"> cross-origin resources sharing</a></span>
<span class='tag'><a href="/tag/middleware.html"> middleware</a></span>
<span class='tag'><a href="/tag/rack.html"> rack</a></span>
<span class='tag'><a href="/tag/rails.html"> rails</a></span>
<span class='tag'><a href="/tag/tr.html"> tr</a></span>
<!-- Share buttons -->
<ul class='share_button'>
<li>
<div class='fb-share-button' data-href='http://lab2023.com/rails-rack-middleware-ve-cors-cross-origin-resource-sharing.html' data-type='button_count'></div>
</li>
<li>
<a class='twitter-share-button' data-text='http://lab2023.com/rails-rack-middleware-ve-cors-cross-origin-resource-sharing.html' data-via='lab2023' href='https://twitter.com/share'></a>
</li>
<li>
<script src='//platform.linkedin.com/in.js' type='text/javascript'>
<![CDATA[
    lang: en_US
]]>
</script>
<script data-url='http://lab2023.com/rails-rack-middleware-ve-cors-cross-origin-resource-sharing.html' type='IN/Share'></script>
</li>
</ul>
</div>
<div class='col-lg-8'>
<article class='post'>
<h1>Rails, Rack Middleware ve CORS (Cross-origin resource sharing)</h1>
<p>Merhaba,</p>

<p>Önceki geliştirdiğim projelerden birisinde oldukça zamanımı yiyen CORS konusu hakkında Rails&rsquo; de bulduğum kısa çözümü sizlerle paylaşmak istiyorum.</p>

<p>Öncelikle CORS konusu hakkında araştırma yapmak isterseniz size aşağıdaki kaynakları önerebilirim;</p>

<ul>
<li>  <a href="http://en.wikipedia.org/wiki/Cross-origin%5C_resource%5C_sharing">http://en.wikipedia.org/wiki/Cross-origin_resource_sharing</a></li>
<li>  <a href="http://www.w3.org/TR/cors/">http://www.w3.org/TR/cors/</a></li>
</ul>

<p>Rails&#39;de bu konuyu response header&#39;ları setleyerek çözüyoruz. Bunun için bir çok çözüm mevcut ama benim gördüğüm kadarıyla en kolay ve sıkı çözüm işi rack katmanında bitirmek. Ama web sunucusu (örn: nginx) katmanında da benzer ayarlar yaparak konuyu çözebiliyorsunuz. Ben en kolay yöntem olan Rack katmanından bahsedeceğim.</p>

<p><code>Rack::Cors</code> adındaki modül ile bu işlemi halletmek için önce aşağıdaki Gem&#39;i rails projemizde Gemfile&#39;a ekliyoruz.</p>

<p><code>gem &quot;rack-cors&quot;, &quot;~&gt; 0.2.7&quot;</code></p>

<p>Bundle install işleminden sonra, <code>config\application.rb</code> dosyamıza gidip en alt satırlarda uygun bir yere aşağıdaki satırları ekliyoruz:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="n">config</span><span class="p">.</span><span class="nf">middleware</span><span class="p">.</span><span class="nf">use</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Cors</span> <span class="k">do</span> <span class="o">|</span><span class="n">requests</span><span class="o">|</span>
  <span class="n">requests</span><span class="p">.</span><span class="nf">allow</span> <span class="k">do</span> <span class="o">|</span><span class="n">allow</span><span class="o">|</span>
    <span class="n">allow</span><span class="p">.</span><span class="nf">origins</span> <span class="s1">'*'</span>
    <span class="n">allow</span><span class="p">.</span><span class="nf">resource</span> <span class="s1">'*'</span><span class="p">,</span> <span class="ss">:headers</span> <span class="o">=&gt;</span> <span class="ss">:any</span><span class="p">,</span> <span class="ss">:methods</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:get</span><span class="p">,</span> <span class="ss">:post</span><span class="p">,</span> <span class="ss">:put</span><span class="p">,</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:options</span><span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Yukarıdaki middleware katmanını ayrı bir initializer dosyası hazırlayarak da kullanabilirsiniz. Bu konu için <a href="http://guides.rubyonrails.org/rails_on_rack.html#inspecting-middleware-stack">http://guides.rubyonrails.org/rails_on_rack.html#inspecting-middleware-stack</a> adresine bir göz atabilirsiniz.</p>

<p>Bu ayarları yaptıktan ve uygulamanızı yeniden başlattıktan sonra artık response header&#39;larında aşağıdaki gibi bir çıktı görüp farklı kaynaklardan uygulamanıza istekler yapılması sağlanmış olacaktır.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Request URL: http://vidipanda-api.dev/videos
Request Method: POST
Status Code: 200 OK
...
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS
Access-Control-Allow-Origin: http://vidipanda-mobile.dev
Access-Control-Expose-Headers:
Access-Control-Max-Age:1728000
...
</code></pre></div>
<p>Bu konunun daha detaylı ele alınması gereken bir konu oldugunu düşünüyorum, bu yüzden ilerleyen zamanlarda imkan olursa bir makale daha çıkarmayı planlıyorum, ama siz beni beklemeyin iyisi mi aşağıdaki kaynakçaya bir göz atın&hellip;</p>

<h3 id="kaynak-a">Kaynakça</h3>

<ul>
<li>  <a href="http://www.html5rocks.com/en/tutorials/cors/">http://www.html5rocks.com/en/tutorials/cors/</a></li>
<li>  <a href="http://www.tsheffler.com/blog/?p=428">http://www.tsheffler.com/blog/?p=428</a></li>
<li>  <a href="http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/">http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/</a></li>
<li>  <a href="http://enable-cors.org/">http://enable-cors.org/</a></li>
<li>  <a href="http://remysharp.com/2011/04/21/getting-cors-working/">http://remysharp.com/2011/04/21/getting-cors-working/</a></li>
<li>  <a href="http://rack.rubyforge.org/doc/">http://rack.rubyforge.org/doc/</a></li>
<li>  <a href="http://railscasts.com/episodes/151-rack-middleware">http://railscasts.com/episodes/151-rack-middleware</a></li>
<li>  <a href="http://amberbit.com/blog/introduction-to-rack-middleware">http://amberbit.com/blog/introduction-to-rack-middleware</a></li>
<li>  <a href="http://rubygems.org/gems/rack-cors%20https://github.com/cyu/rack-cors">http://rubygems.org/gems/rack-cors https://github.com/cyu/rack-cors</a></li>
</ul>

<p>İyi çalışmalar.</p>

<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'lab2023';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>
Please enable JavaScript to view the
<a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
</noscript>
<a class='dsq-brlink' href='http://disqus.com'>
comments powered by
<span class='logo-disqus'>Disqus</span>
</a>
</article>
</div>
</div>
</div>
<footer class='footer'>
<h4>© 2009 ~ 2023 LAB2023, CORP.</h4>
<p>The all designs, materials and contents trademarks of lab2023, corp.</p>
</footer>

</body>
<!-- Javascripts -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script><script src="assets/javascripts/vendor/swiper-bundle.min.js"></script><script src="assets/javascripts/application.js"></script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12243799-3']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</html>
