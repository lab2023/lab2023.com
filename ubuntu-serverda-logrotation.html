<!DOCTYPE html>
<html class='no-js' lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>lab2023 | web & mobile development, graphic design company - Ubuntu serverda logrotation
</title>
<meta content='Designers and developers for hire' name='description'>
<meta content='design, ruby, ruby on rails, ios, android, sencha, istanbul, ankara, denizli, turkey' name='keywords'>
<link href="assets/stylesheets/application.css" rel="stylesheet" /><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" /><link href="assets/stylesheets/swiper-bundle.min.css" rel="stylesheet" />
<link href="assets/images/favicon.png" rel="icon" type="image/png" />
<meta content='Ubuntu serverda logrotation' name='description'>
<meta content='ubuntu, log, logrotate, log rotation, linux, tr' name='keywords'>
<meta content='Hamit Türkü KAYA' name='author'>


</head>
<body id='blog'>
<header class='header'>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1'>
<a href="/blog"><img class="logo pull-right" width="252" height="253" src="assets/images/logo.png" alt="Logo" />
</a></div>
<div class='col-lg-8'>
<h1>
<a href="/blog">lab2023's blog posts</a>
<a href="http://lab2023.com/feed.xml" target="_blank"><i class='fa fa-rss'></i>
</a></h1>
<div class='row'>
<div class='col-lg-3'>
<p>
<a href="/"><i class='fa fa-arrow-circle-left'></i>
lab2023.com
</a></p>
</div>
<div class='col-lg-9' id='language_linked'>
<p>
<a href="/tag/tr.html">Türkçe
</a>·
<a href="/tag/en.html">English
</a>·
<a href="/tag/es.html">Español
</a>·
<a href="/tag/ru.html">Русский
</a></p>
</div>
</div>
</div>
</div>
</div>
</header>

<!-- share-buttons js code -->
<div id='fb-root'>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/tr_TR/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
  (function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs'));
</script>
</div>
<div class='container'>
<div class='row'>
<div class='col-lg-2 col-lg-offset-1 article-meta'>
<h4><a href="http://twitter.com/hamitturkukaya" target="_blank">Hamit Türkü KAYA</a></h4>
<h5>May 23, 2014</h5>
<span class='tag'><a href="/tag/ubuntu.html">ubuntu</a></span>
<span class='tag'><a href="/tag/log.html"> log</a></span>
<span class='tag'><a href="/tag/logrotate.html"> logrotate</a></span>
<span class='tag'><a href="/tag/log-rotation.html"> log rotation</a></span>
<span class='tag'><a href="/tag/linux.html"> linux</a></span>
<span class='tag'><a href="/tag/tr.html"> tr</a></span>
<!-- Share buttons -->
<ul class='share_button'>
<li>
<div class='fb-share-button' data-href='http://lab2023.com/ubuntu-serverda-logrotation.html' data-type='button_count'></div>
</li>
<li>
<a class='twitter-share-button' data-text='http://lab2023.com/ubuntu-serverda-logrotation.html' data-via='lab2023' href='https://twitter.com/share'></a>
</li>
<li>
<script src='//platform.linkedin.com/in.js' type='text/javascript'>
<![CDATA[
    lang: en_US
]]>
</script>
<script data-url='http://lab2023.com/ubuntu-serverda-logrotation.html' type='IN/Share'></script>
</li>
</ul>
</div>
<div class='col-lg-8'>
<article class='post'>
<h1>Ubuntu serverda logrotation</h1>
<p>Serverlarımızda tutulan log dosyaları bir yerden sonra devasa boyutlara ulaşarak depolanması ve gerektiği zaman incelenmesi eziyet haline gelebiliyor. Bu yüzden log dosyalarımızı parçalara ayırıp bu parçaları sıkıştırarak saklamak, hem lazım olduğu zaman inceleme yapılmasını, hem de log dosyasının diskte tutulduğu alanı oldukça küçültüp sabit diskimizin rahat bir nefes almasını sağlayacaktır.</p>

<p>Bunu yapabilmek için Ubuntu&#39;da logrotate adlı uygulamayı kullanıyoruz. Öncelikle sunucumuza yüklü değilse yüklememiz gerekiyor.</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>logrotate
</code></pre></div>
<p>Komutunu çalıştırdıktan sonra uygulamamız kurulacaktır. Doğrulamak için terminalde;</p>
<div class="highlight"><pre class="highlight shell"><code>logrotate
</code></pre></div>
<p>yazabilirsiniz. Kurulduysa uygulama bilgilerini gösterecektir.</p>

<p>Gerekli ayarları yapmak için;</p>
<div class="highlight"><pre class="highlight shell"><code><span class="o">(</span><span class="nb">sudo</span><span class="o">)</span> vi /etc/logrotate.conf
</code></pre></div>
<p>komutu ile ayar dosyamızı açıyoruz. Uygulamanın en altına düzenlemek istediğimiz log dosyalarının adresini tanımlayıp ayar parametrelerini giriyoruz.</p>
<div class="highlight"><pre class="highlight shell"><code>/home/deployer/apps/app_name/current/log/<span class="k">*</span>.log <span class="o">{</span>
  weekly        <span class="c"># Periyot</span>
  missingok     <span class="c"># Dosyayı bulamaması durumundaki davranışı</span>
  rotate 52     <span class="c"># Kaç adet dosya tutacağının sayısı</span>
  compress      <span class="c"># Sıkıştırma istenip istenmediğine göre eklenir</span>
  notifempty    <span class="c"># Eğer log dosyası boş ise işlem yapmaz</span>
  copytruncate  <span class="c"># Yedekledikten sonra orjinal log dosyasını silip yeni bir tane oluşturur</span>
  size 1024M    <span class="c"># Log dosyası boyut sınırı</span>
<span class="o">}</span>
</code></pre></div>
<p>Bu parametreler zorunlu olmayıp ihtiyaca yönelik olarak eklenmektedir. Log dosyalarının çabuk genişlediği bir sistemde günlük rotasyon yapmak gerekirken, ihtiyaca göre ayda bir de yapabilirsiniz (daily, weekly, monthly). Hatta örnekteki gibi boyut sınırı da vererek eğer 1 GB&#39;ı aşmadıysa rotasyonu yapmayacaktır. Ayrıca logrotator tutacağı dosya sayısını da sizden istemektedir. 10 verdiyseniz 10 adet yedeğe ulaştığı zaman en eski dosyayı silerek işlemine devam eder, bu yüzden ihtiyacı iyi düşünmeniz veya sıkıştırılmış log dosyalarını farklı bir dosyada yedeklemeniz yararınıza olacaktır. Bunları sağlamak için</p>
<div class="highlight"><pre class="highlight shell"><code>postrotate
...
endscript

<span class="c">#veya</span>

prerotate
...
endscript
</code></pre></div>
<p>şeklinde rotasyondan sonra çalışacak scriptler oluşturabilirsiniz.</p>

<p>Eğer yazdığınız scriptin hemen çalışmasını istiyorsanız</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nb">sudo </span>logrotate <span class="nt">-f</span> /etc/logrotate.conf
</code></pre></div>
<p>komutunu kullanabilir, ayrıca</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nb">cat</span> /var/lib/logrotate/status
</code></pre></div>
<p>komutu ile de zamanlanmış görevler içerisinde log rotationunuzun durumunu görebilirsiniz. </p>

<p>Logrotation ile ilgili daha detaylı bilgiyi <a href="http://linuxcommand.org/man_pages/logrotate8.html">man sayfasından</a> bulabilirsiniz.</p>

<div id='disqus_thread'></div>
<script>
  var disqus_shortname = 'lab2023';
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>
Please enable JavaScript to view the
<a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
</noscript>
<a class='dsq-brlink' href='http://disqus.com'>
comments powered by
<span class='logo-disqus'>Disqus</span>
</a>
</article>
</div>
</div>
</div>
<footer class='footer'>
<h4>© 2009 ~ 2023 LAB2023, CORP.</h4>
<p>The all designs, materials and contents trademarks of lab2023, corp.</p>
</footer>

</body>
<!-- Javascripts -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script><script src="assets/javascripts/vendor/swiper-bundle.min.js"></script><script src="assets/javascripts/application.js"></script>
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12243799-3']);
  _gaq.push(['_trackPageview']);
  
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</html>
